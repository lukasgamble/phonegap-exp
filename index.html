<!DOCTYPE html>
<!--[if IEMobile 7 ]>    <html class="no-js iem7"> <![endif]-->
<!--[if (gt IEMobile 7)|!(IEMobile)]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>Vehotrans Mobile</title>
        <meta name="description" content="">
        
        <!-- Mobile Tags -->
        <meta content="initial-scale=1.0, user-scalable=no" name="viewport">
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />	
        <meta name="apple-mobile-web-app-capable" content="yes">
        
		<!-- You can put your own logo below linking photos for splash screen-->
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/images/touch/appleTouchIcon144x144Precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/images/touch/appleTouchIcon114x114Precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/images/touch/appleTouchIcon72x72Precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="assets/images/touch/appleTouchIcon57x57Precomposed.png">
        <link rel="shortcut icon" href="assets/images/touch/appleTouchIcon.png">
	<link rel="apple-touch-startup-image" href="assets/images/startup/startupRetina.jpg" />
	<!-- / Mobile Tags -->
        
        <!-- Splash screens -->
        <!-- iPhone 320x460 -->
        <link href="assets/images/splashscreens/appleTouchStartupImage320x460.png" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)" rel="apple-touch-startup-image">
        <!-- iPhone (Retina) 640x920 -->
        <link href="assets/images/splashscreens/appleTouchStartupImage640x920.png" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
        <!-- iPhone 5 640x1096-->
        <link href="assets/images/splashscreens/appleTouchStartupImage640x1096.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
        <!-- iPad 768x1004 / 748x1024-->
        <link href="assets/images/splashscreens/appleTouchStartupImage768x1004.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 1)" rel="apple-touch-startup-image">
        <link href="assets/images/splashscreens/appleTouchStartupImage748x1024.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 1)" rel="apple-touch-startup-image">
        <!-- iPad (Retina) 1536x2008 / 1496x2048 -->
        <link href="assets/images/splashscreens/appleTouchStartupImage1536x2008.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
        <link href="assets/images/splashscreens/appleTouchStartupImage1496x2048.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
  	<!-- / Splash Screens -->

	
	<link rel="stylesheet" href="assets/css/jqueryMobile130Min.css" />
	
	
        <link rel="stylesheet" href="assets/css/add2home.css">
        <link rel="stylesheet" href="assets/css/icons/icons.css" type="text/css" >
        <link rel="stylesheet" href="assets/css/icons/navIcons.css" type="text/css" >
	<link rel="stylesheet" href="assets/css/style.css" type="text/css" >
        <link rel="stylesheet" href="assets/css/normalize.css">
        <link rel="stylesheet" href="assets/css/main.css">
	<link rel="stylesheet" href="assets/css/vehotrans.css">
	<link rel="stylesheet" href="assets/css/validation.css">
        <link rel="stylesheet" type="text/css" href="assets/css/icons/navIconsBlack.css"> 
        <!-- / CSS Files -->
        
        <!-- This script prevents links from opening in Mobile Safari. https://gist.github.com/1042026 -->
        <!--
        <script>(function(a,b,c){if(c in b&&b[c]){var d,e=a.location,f=/^(a|html)$/i;a.addEventListener("click",function(a){d=a.target;while(!f.test(d.nodeName))d=d.parentNode;"href"in d&&(d.href.indexOf("http")||~d.href.indexOf(e.host))&&(a.preventDefault(),e.href=d.href)},!1)}})(document,window.navigator,"standalone")</script>
        -->
        <script src="assets/js/vendor/modernizr261Min.js"></script>
	
	<!-- JQUERY -->
	<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
	
	<!-- APP INIT SCRIPTS -->
	<script src="assets/js/helper.js"></script>
	<script src="assets/js/app.js"></script>
	
	<!-- JQUERY MOBILE -->
	<script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
	
	<!-- JQUERY VALIDATE -->
	<script src="assets/js/jqueryValidateMin.js"></script>
	
	
	

	
</head>
    <body>        
    	
	
	
	
	
	
	<!-- Menu Begin -->
        <div id="menu">
        		
                <!-- Social Links -->
            	<div class="social-links">
                    <!--<p><a class="twitter" href="#"></a></p>
                    <p><a class="rss" href="#"></a></p>
                    <p><a class="facebook" href="#"></a></p>
                    <p><a class="googleplus" href="#"></a></p>
                    <p><a class="linkedin" href="#"></a></p>-->
		    <p>&nbsp;</p>
                </div>
                <!-- / Social Links -->
                <div class="hr-full-black"></div>
            
           	<ul>
			<li class="active"><a href="#home" class="contentLink" data-transition="slide">Home <span class="icon"></span></a></li>
			<li><a href="#jobs" class="contentLink" data-transition="slide">My Jobs<span class="icon"></span></a></li>
			<li><a href="#routes" class="contentLink" data-transition="slide">My Routes<span class="icon"></span></a></li>
			<li><a href="#myAccount" class="contentLink" data-transition="slide">My Account<span class="icon"></span></a></li>
			<li><a href="#support" class="contentLink" data-transition="slide">Support<span class="icon"></span></a></li>
			
			<li><a href="#availability" class="contentLink" data-transition="slide">Post Availability<span class="icon"></span></a></li>
			<li><a href="#gps_map" class="contentLink" data-transition="slide">Loads Near Me<span class="icon"></span></a></li>
			<li><a href="#updateStatus" class="contentLink" data-transition="slide">Job Status<span class="icon"></span></a></li>
			<li><a href="#POD" class="contentLink" data-transition="slide">P.O.D.<span class="icon"></span></a></li>
			<li><a href="#login" class="contentLink" data-transition="slide">Logout<span class="icon"></span></a></li>
               </ul>
            
            
        </div>
        <!-- /Menu -->
        
        
        <!--<div id="page-selector">-->
	
	<!-- *********************************************************
       	 LOGIN PAGE BEGIN
        ********************************************************* -->
	<div data-role="page" id="login" data-theme="a">
		
		<form id="loginForm" name="loginForm" action="javascript:;" method="post">
			<!-- Header Begin -->
			<div data-role="header" class="header" data-theme="a">
				<div class="logo"></div>
			</div>
			
			<div data-role="content">
				<h2 style="text-align: center">Login</h2>
				<p style="text-align: center">Please use your Vehotrans login details to access our mobile services.</p>
				
				
				<div class="field control-group" style="margin: 20px 0;">
					<label for="txtEmail" class="control-label">Email:</label>
					<div class="controls">
						<input type="text" name="txtEmail" id="txtEmail" class="required email" />
					</div>
				</div>
				
				<div class="field control-group" style="margin: 0 0 20px 0;">
					<label for="txtPassword" class="control-label">Password:</label>
					<div class="controls">
						<input type="password" name="txtPassword" id="txtPassword" class="required" />
					</div>
				</div>
				
				
				<button data-theme="b" id="btnLogin">Login</button>
				<div class="clearfix"></div>
			</div>
		
		</form>
	</div>
	
	
	
	<!-- *********************************************************
       	 LOGIN PAGE END
        ********************************************************* -->
	
        
        <!-- *********************************************************
       	 HOME PAGE BEGIN
        ********************************************************* -->
        <div data-role="page" class="pages" id="home" data-theme="a">
        	
            <!-- Header Begin -->
	    <div data-role="header" class="header" data-theme="a">
            <div class="logo"></div>
	    <a href="#" class="showMenu menuBtn">Menu</a>
	    <a href="javascript:;" class="homeBtn">Home</a>
            </div>
            <!-- /header -->
            
	    <!-- breadcrumb -->
            <ul class="breadcrumb">
                <li><span id="welcomeText" style="background-image: none !important;">Welcome Back</span></li>
            </ul>
            <!-- / breadcrumb-->
	    
	    
            <!-- Content Begin -->
            <div data-role="content">
            	
		
		<div class="ui-grid-a" style="margin-bottom: 2em;margin-top: 2em;">
			<div class="ui-block-a">
				<div class="veho-button-wrapper">
					<a href="#availability" data-transition="slideup"><img src="assets/images/buttons/van.png" id="lnkAvailability" /></a>
					<br />Post Availability
				</div>
			</div>
			<div class="ui-block-b">
				<div class="veho-button-wrapper">
					<a href="#gps_map" data-transition="slideup"><img src="assets/images/buttons/geoLocation.png"  id="lnkNearMe" /></a>
					<br />Loads Near Me
				</div>
			</div>
			
		</div>
		
		<div class="ui-grid-a">
			<div class="ui-block-a">
				<div class="veho-button-wrapper">
					<a href="#updateStatus" data-transition="slideup"><img src="assets/images/buttons/status.png" id="lnkUpdateStatus" /></a>
					<br />Update Status
				</div>
			</div>
			<div class="ui-block-b">
				<div class="veho-button-wrapper">
					<a href="#POD" data-transition="slideup"><img src="assets/images/buttons/POD.png" id="lnkPOD" /></a>
					<br />Proof Of Delivery
				</div>
			</div>
		</div>
		
		
                
          	<div class="clearfix"></div>
				
                
                
        
            </div>
            <!-- /content -->
        </div>
        <!-- *********************************************************
       	 HOME PAGE END
        ********************************************************* -->
        
        
	
	<!-- *********************************************************
       	 AVAILABILITY PAGE BEGIN
        ********************************************************* -->
		<div data-role="page" id="availability" data-theme="a" class="pages">
		
			<div data-role="header" class="header" data-theme="a">
			<a href="javascript:;" class="showMenu menuBtn">Menu</a>
			<div class="logo">&nbsp;</div>
			<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
			</div>
			    
			<div data-role="content" data-theme="a">	
				<h2>Post Availability</h2>
				<p>Need to add a form here!</p>
				
				
				<a href="javascript:;" id="hideTest">hide me</a>
				
			</div><!-- /content -->
		</div>
	<!-- *********************************************************
       	 AVAILABILITY PAGE END
        ********************************************************* -->	
		
	
	
	
	<!-- *********************************************************
       	 NEARME PAGE BEGIN
        ********************************************************* -->
		<div data-role="page" id="loadsNearMe" data-theme="a" class="pages">
		
			<div data-role="header" class="header" data-theme="a">
				<a href="javascript:;" class="showMenu menuBtn">Menu</a>
				<div class="logo">&nbsp;</div>
				<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
			</div>
		
			<div data-role="content" data-theme="a">	
				<h2>Loads Near Me</h2>
				<p>Need to add a Google Map here!</p>
				
			</div><!-- /content -->
		</div>
		
		<div id="gps_map" data-role="page" data-theme="a" class="pages">
			<div data-role="header" class="header" data-theme="a">
				<a href="javascript:;" class="showMenu menuBtn">Menu</a>
				<!--<div class="logo">&nbsp;</div>-->
				<h1>Loads Near Me</h1>
				<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
			</div>
			<div data-role="content">	
				<div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
					<div id="map_canvas_2" style="height:300px;"></div>
				</div>
			</div>
		</div>
	<!-- *********************************************************
       	 NEARME PAGE END
        ********************************************************* -->
		
	
	<!-- *********************************************************
       	 UPDATESTATUS PAGE BEGIN
        ********************************************************* -->
		<div data-role="page" id="updateStatus" data-theme="a" class="pages">
		
			<div data-role="header" class="header" data-theme="a">
			<a href="javascript:;" class="showMenu menuBtn">Menu</a>
			<div class="logo">&nbsp;</div>
			<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
			</div>
		
			<div data-role="content" data-theme="a">	
				<h2>Update your status</h2>
				<p>Another Form...or just a clickable list view?</p>
				
			</div><!-- /content -->
		</div>
	<!-- *********************************************************
       	 UPDATESTATUS PAGE END
        ********************************************************* -->	
		
	
		
	<!-- *********************************************************
       	 P.O.D. PAGE BEGIN
        ********************************************************* -->	
		<div data-role="page" id="POD" data-theme="a" class="pages">
		
			<div data-role="header" class="header" data-theme="a">
			<a href="javascript:;" class="showMenu menuBtn">Menu</a>
			<div class="logo">&nbsp;</div>
			<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
			</div>
		
			<div data-role="content" data-theme="a">	
				<h2>Generata a POD for your Delivery</h2>
				<p>Image capture?</p>
				
			</div><!-- /content -->
		</div>
	<!-- *********************************************************
       	 P.O.D. PAGE END
        ********************************************************* -->
		
		
		
	<!-- *********************************************************
       	 MYACCOUNT PAGE BEGIN
        ********************************************************* -->
		<div data-role="page" id="myAccount" data-theme="a" class="pages">
		
			<div data-role="header" class="header" data-theme="a">
			<a href="javascript:;" class="showMenu menuBtn">Menu</a>
			<div class="logo">&nbsp;</div>
			<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
			</div>
		
			<div data-role="content" data-theme="a">	
				<h2>My Account</h2>
				<p>Change password</p>
				
			</div><!-- /content -->
		</div>
	<!-- *********************************************************
       	 MYACCOUNT PAGE END
        ********************************************************* -->
        
	
	<!-- *********************************************************
       	 LOGIN DIALOGE PAGE START
        ********************************************************* -->
	<div data-role="popup" id="loginDialog" data-overlay-theme="a" data-theme="b" data-dismissible="false" data-position-to="window" class="ui-corner-all">
		<div data-role="header" data-theme="a" class="ui-corner-top">
		    <h1>Login Failed</h1>
		</div>
		<div data-role="content" data-theme="d" class="ui-corner-bottom ui-content" style="text-align: center;">
		    <p>Sorry, email &amp; password combination not recognised.</p>
		    <a href="javascript:;" data-role="button" data-inline="true" data-rel="back" data-theme="b">Try Again</a>
		</div>
	</div>
	<!-- *********************************************************
       	 LOGIN DIALOGE PAGE END
        ********************************************************* -->
	
	<!--</div>-->
	
	<div id="userDataStore"></div>

	<!-- DETECT BROWSER MIGRATION PATCH -->
	<script src="assets/js/jqueryMbBrowserMin.js"></script>
	
	
	<!-- JQUERY MOBILE VEHOTRANS THEME INIT -->
	<script src="assets/js/Theme.js"></script>
	
	<!-- EXTRAS -->
        <script src="assets/js/vendor/zeptoMin.js"></script>
        <script src="assets/js/add2home.js" charset="utf-8"></script><!-- Iphone Bubble  -->
        
	<!-- GOOGLE MAPS -->
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false&libraries=places"></script> 
	<script type="text/javascript" src="assets/js/demo.js"></script>
	<script type="text/javascript" src="assets/js/jqueryUiMap.js"></script>
	<script type="text/javascript" src="assets/js/jqueryUiMapServices.js"></script>
	<script type="text/javascript" src="assets/js/jqueryUiMapExtensions.js"></script>
	
	<script>
		
		var baseUrl = "http://vehotrans.azurewebsites.net/";

   
		
		$(document).ready(function() {
			
			// needs to be present
			$(this).delegate("body", "pageinit", function(ev, data){
				//alert("pageinit called");
				}); 
			
			
			
			Theme.init();
			var rules = {
				rules: {
				}
			};
			var validationHandlers = {
				submitHandler: function(form){
							//alert("form validator has been run!");
							login();
						}
				
			}
			
			Theme.showValidationTicks = false;
			var validationObj = $.extend(
						     rules,
						     validationHandlers,
						     Theme.validationRules
						     );
			$('#loginForm').validate(validationObj);


				
			var login = function () {	
				
				$.mobile.loading( 'show', {
					text: "Authenticating...",
					textVisible: true,
					theme: "a",
					textonly: false
				});
				
				$.ajax({
					type: "GET",
					url: baseUrl + "rest/Person/" + $("#txtEmail").val() + "/" + $("#txtPassword").val(),
					contentType: 'application/json; charset=utf-8',
					dataType: "json",
					success: function (data) {
						
						if(data.Authenticated){
							// hide the loader
							$.mobile.loading("hide");
							// hide the dialog
							$('#loginDialog').hide();
							//store credentials with the userDataStore div object
							$("#userDataStore").data({"firstName": data.FirstName, "lastName": data.LastName, "email": data.EmailAddress, "GUID": data.PersonGuid});
							// display the username
							//console.log($("#userDataStore").data("FirstName") + ' ' + $("#userDataStore").data("LastName"));
							$("#welcomeText").html('Welcome back ' + $("#userDataStore").data("firstName") + ' ' + $("#userDataStore").data("lastName"));
							// load the homescreen
							$.mobile.changePage($('#home'), {transition:"fade"});
						}else{
							$.mobile.loading("hide");
							$.mobile.changePage('#loginDialog', {role: 'dialog'});
						}
						
						},
					error: function(jqXHR, textStatus, errorThrown ){
						$.mobile.loading("hide");
						$.mobile.changePage('#loginDialog', {role: 'dialog'});
						}
				});
				return false;
			//});
			};
		});
		

		
		////////////////////////////////////////////////////////////
		var mobileDemo = { 'center': '51.530052,-0.101023', 'zoom': 10};
		
		$('#gps_map').live('pageinit', function() {
			demo.add('gps_map', function() {
				$('#map_canvas_2').gmap({'center': mobileDemo.center, 'zoom': mobileDemo.zoom, 'disableDefaultUI':true, 'callback': function(map) {
					var self = this;
					self.watchPosition(function(position, status) {
						if ( status === 'OK' ) {
							var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
							if ( !self.get('markers').client ) {
								self.addMarker({ 'id': 'client', 'position': latlng, 'bounds': true });
							} else {
								self.get('markers').client.setPosition(latlng);
								map.panTo(latlng);
							}
						}
					});
				}});
			}).load('gps_map');
		});
		
		$('#gps_map').live('pageshow', function() {
			demo.add('gps_map', function() { $('#map_canvas_2').gmap('refresh'); }).load('gps_map');
		});
		
		$('#gps_map').live("pagehide", function() {
			demo.add('gps_map', function() { $('#map_canvas_2').gmap('clearWatch'); }).load('gps_map');
		});
		
		////////////////////////////////////////////////////////////
		
		
	</script>
	
    </body>
</html>
