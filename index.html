<!DOCTYPE html>
<!--[if IEMobile 7 ]>    <html class="no-js iem7"> <![endif]-->
<!--[if (gt IEMobile 7)|!(IEMobile)]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>Vehotrans Mobile</title>
        <meta name="description" content="">
        
        <!-- Mobile Tags -->
        <meta content="initial-scale=1.0, user-scalable=no" name="viewport">
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />	
        <meta name="apple-mobile-web-app-capable" content="yes">
        
		<!-- You can put your own logo below linking photos for splash screen-->
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/images/touch/appleTouchIcon144x144Precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/images/touch/appleTouchIcon114x114Precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/images/touch/appleTouchIcon72x72Precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="assets/images/touch/appleTouchIcon57x57Precomposed.png">
        <link rel="shortcut icon" href="assets/images/touch/appleTouchIcon.png">
	<link rel="apple-touch-startup-image" href="assets/images/startup/startupRetina.jpg" />
	<!-- / Mobile Tags -->
        
        <!-- Splash screens -->
        <!-- iPhone 320x460 -->
        <link href="assets/images/splashscreens/appleTouchStartupImage320x460.png" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)" rel="apple-touch-startup-image">
        <!-- iPhone (Retina) 640x920 -->
        <link href="assets/images/splashscreens/appleTouchStartupImage640x920.png" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
        <!-- iPhone 5 640x1096-->
        <link href="assets/images/splashscreens/appleTouchStartupImage640x1096.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
        <!-- iPad 768x1004 / 748x1024-->
        <link href="assets/images/splashscreens/appleTouchStartupImage768x1004.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 1)" rel="apple-touch-startup-image">
        <link href="assets/images/splashscreens/appleTouchStartupImage748x1024.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 1)" rel="apple-touch-startup-image">
        <!-- iPad (Retina) 1536x2008 / 1496x2048 -->
        <link href="assets/images/splashscreens/appleTouchStartupImage1536x2008.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
        <link href="assets/images/splashscreens/appleTouchStartupImage1496x2048.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
  	<!-- / Splash Screens -->

	
	<!--<link rel="stylesheet" href="assets/css/jqueryMobile130Min.css" />-->
	<!--<link rel="stylesheet" href="assets/css/jquery.mobile-1.3.0.css" />-->
	<!--<link rel="stylesheet" href="assets/css/jquery.mobile-1.3.0.min.css" />-->
	<!--<link rel="stylesheet" href="assets/css/jquery.mobile-1.2.1.min.css" />-->
	<!--<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.1/jquery.mobile-1.2.1.min.css" />-->
	<!--<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />-->
	<link rel="stylesheet" href="assets/css/jqueryMobile130Min.css" />
	
        <link rel="stylesheet" href="assets/css/add2home.css">
        <link rel="stylesheet" href="assets/css/icons/icons.css" type="text/css" >
        <link rel="stylesheet" href="assets/css/icons/navIcons.css" type="text/css" >
	<link rel="stylesheet" href="assets/css/style.css" type="text/css" >
        <link rel="stylesheet" href="assets/css/normalize.css">
        <link rel="stylesheet" href="assets/css/main.css">
	<link rel="stylesheet" href="assets/css/vehotrans.css">
	<link rel="stylesheet" href="assets/css/validation.css">
        <link rel="stylesheet" type="text/css" href="assets/css/icons/navIconsBlack.css"> 
        <!-- / CSS Files -->
        
	
	<!-- PHONEGAP!!!!! -->
	<script src="phonegap.js"></script>
	
	
        <!-- This script prevents links from opening in Mobile Safari. https://gist.github.com/1042026 -->
        <!--
        <script>(function(a,b,c){if(c in b&&b[c]){var d,e=a.location,f=/^(a|html)$/i;a.addEventListener("click",function(a){d=a.target;while(!f.test(d.nodeName))d=d.parentNode;"href"in d&&(d.href.indexOf("http")||~d.href.indexOf(e.host))&&(a.preventDefault(),e.href=d.href)},!1)}})(document,window.navigator,"standalone")</script>
        -->
        <script src="assets/js/vendor/modernizr261Min.js"></script>
	
	<!-- JQUERY -->
	<!--<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>-->
	<script src="assets/js/jquery182min.js"></script>
	
	<!-- APP INIT SCRIPTS -->
	<script src="assets/js/helper.js"></script>
	<script src="assets/js/app.js"></script>
	
	<!-- JQUERY MOBILE -->
	<!--<script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>-->
	<script src="assets/js/jqueryMobile130min.js"></script>
	
	<!-- JQUERY VALIDATE -->
	<script src="assets/js/jqueryValidateMin.js"></script>
	
	
	
	
	

	
</head>
    <body>        
    	
	
	
	
	
	
	<!-- Menu Begin -->
        <div id="menu" style="display: none;">
        		
                <!-- Social Links -->
            	<div class="social-links">
                    <!--<p><a class="twitter" href="#"></a></p>
                    <p><a class="rss" href="#"></a></p>
                    <p><a class="facebook" href="#"></a></p>
                    <p><a class="googleplus" href="#"></a></p>
                    <p><a class="linkedin" href="#"></a></p>-->
		    <p>&nbsp;</p>
                </div>
                <!-- / Social Links -->
                
            
           	<ul>
			<li><a href="#home" class="contentLink" data-transition="slide">Home <span class="icon"></span></a></li>
		</ul>
			<div class="separator">Manage</div>
		<ul>
			<li><a href="#jobs" class="contentLink" data-transition="slide">My Jobs<span class="icon"></span></a></li>
			<!--<li><a href="#routes" class="contentLink" data-transition="slide">My Routes<span class="icon"></span></a></li>-->
			<li><a href="#myAccount" class="contentLink" data-transition="slide">My Account<span class="icon"></span></a></li>
			<li><a href="#support" class="contentLink" data-transition="slide">Support<span class="icon"></span></a></li>
		</ul>
		<div class="separator">Functions</div>
		<ul>	
			<li><a href="#availability" class="contentLink" data-transition="slide">Post Availability<span class="icon"></span></a></li>
			<li><a href="#gps_map" class="contentLink" data-transition="slide">Loads Near Me<span class="icon"></span></a></li>
			<li><a href="#updateStatus" class="contentLink" data-transition="slide">Job Status<span class="icon"></span></a></li>
			<li><a href="#POD" class="contentLink" data-transition="slide">P.O.D.<span class="icon"></span></a></li>
		</ul>
		<div class="separator">Exit</div>
		<ul>
			<li><a href="#login" class="contentLink" data-transition="slide">Logout<span class="icon"></span></a></li>
               </ul>
            
            
        </div>
        <!-- /Menu -->
        
        
        <!--<div id="page-selector">-->
	
	<!-- *********************************************************
       	 LOGIN PAGE BEGIN
        ********************************************************* -->
	<div data-role="page" id="login" data-theme="a">
		
		<form id="loginForm" name="loginForm" action="javascript:;" method="post" class="xvalidate">
			<!-- Header Begin -->
			<div data-role="header" class="header" data-theme="a">
				<div class="logo"></div>
			</div>
			
			<div data-role="content">
				<h2 style="text-align: center">Login</h2>
				<p style="text-align: center">Please use your Vehotrans login details to access our mobile services.</p>
				
				
				<div class="field control-group" style="margin: 20px 0;">
					<label for="txtEmail" class="control-label">Email:</label>
					<div class="controls">
						<input type="text" name="txtEmail" id="txtEmail" class="required email" />
					</div>
				</div>
				
				<div class="field control-group" style="margin: 0 0 20px 0;">
					<label for="txtPassword" class="control-label">Password:</label>
					<div class="controls">
						<input type="password" name="txtPassword" id="txtPassword" class="required" />
					</div>
				</div>
				
				
				<button data-theme="b" id="btnLogin">Login</button>
				<div class="clearfix" style="margin-bottom: 100px;"></div>
			</div>
		
		</form>
	</div>
	
	
	
	<!-- *********************************************************
       	 LOGIN PAGE END
        ********************************************************* -->
	
        
        <!-- *********************************************************
       	 HOME PAGE BEGIN
        ********************************************************* -->
        <div data-role="page" class="pages" id="home" data-theme="a">
        	
            <!-- Header Begin -->
	    <div data-role="header" class="header" data-theme="a">
            <div class="logo"></div>
	    <a href="#" class="showMenu menuBtn">Menu</a>
	    <a href="javascript:;" class="homeBtn">Home</a>
            </div>
            <!-- /header -->
            
	    <!-- breadcrumb -->
            <ul class="breadcrumb">
                <li><span id="welcomeText" style="background-image: none !important;">Welcome Back</span></li>
            </ul>
            <!-- / breadcrumb-->
	    
	    
            <!-- Content Begin -->
            <div data-role="content">
            	
		
		<div class="ui-grid-a" style="margin-bottom: 2em;margin-top: 2em;">
			<div class="ui-block-a">
				<div class="veho-button-wrapper">
					<a href="#availability" data-transition="slideup"><img src="assets/images/buttons/van.png" id="lnkAvailability" /></a>
					<br />Post Availability
				</div>
			</div>
			<div class="ui-block-b">
				<div class="veho-button-wrapper">
					<a href="#gps_map" data-transition="slideup"><img src="assets/images/buttons/geoLocation.png"  id="lnkNearMe" /></a>
					<br />Loads Near Me
				</div>
			</div>
			
		</div>
		
		<div class="ui-grid-a">
			<div class="ui-block-a">
				<div class="veho-button-wrapper">
					<a href="#updateStatus" data-transition="slideup"><img src="assets/images/buttons/status.png" id="lnkUpdateStatus" /></a>
					<br />Update Status
				</div>
			</div>
			<div class="ui-block-b">
				<div class="veho-button-wrapper">
					<a href="#POD" data-transition="slideup"><img src="assets/images/buttons/POD.png" id="lnkPOD" /></a>
					<br />Proof Of Delivery
				</div>
			</div>
		</div>
		
		
                
          	<div class="clearfix" style="margin-bottom: 300px;"></div>
				
                
                
        
            </div>
            <!-- /content -->
        </div>
        <!-- *********************************************************
       	 HOME PAGE END
        ********************************************************* -->
        
        
	
	<!-- *********************************************************
       	 AVAILABILITY PAGE BEGIN
        ********************************************************* -->
		<div data-role="page" id="availability" data-theme="c" class="pages">
		
			<form id="availabilityForm" name="availabilityForm" action="javascript:;" method="post" class="validate">
				<div data-role="header" class="header" data-theme="a">
				<a href="javascript:;" class="showMenu menuBtn">Menu</a>
				<div class="logo">&nbsp;</div>
				<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
				</div>
				    
				<div data-role="content" data-theme="c">	
					<h2 style="text-align: center">Your Availability</h2>
					<p style="text-align: center">Use this form to notify the Vehotrans Freight Exchange that you are available for new loads</p>
					
					
					<div class="field control-group" style="margin: 20px 0;">
						<div class="controls">
							<select id="ddlVehicle" data-placeholder="true" class="required initial">
								<option value="">
									Select Your Vehicle...
								</option>
							</select>
						</div>
					</div>
					
					<div class="field control-group" style="margin: 0 0 20px 0;">
						
						<div class="controls">
							<label for="cboAvailabilityLocation" style="text-align: center">
								<input type="checkbox" name="cboAvailabilityLocation" checked="checked">Display Your Current Location
							</label>
						</div>
					</div>
					
					<button data-theme="b" id="btnPostAvailability">Post Availablity!</button>
					<div class="clearfix" style="margin-bottom: 100px;"></div>
					
				</div><!-- /content -->
			</form>
		</div>
	<!-- *********************************************************
       	 AVAILABILITY PAGE END
        ********************************************************* -->	
		
	
	
	
	<!-- *********************************************************
       	 NEARME PAGE BEGIN
        ********************************************************* -->		
		<div id="gps_map" data-role="page" data-theme="c">
			<div data-role="header" class="header" data-theme="a">
				<a href="javascript:;" class="showMenu menuBtn">Menu</a>
				<!--<div class="logo">&nbsp;</div>-->
				<h1>Loads Near Me</h1>
				<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
			</div>
			<div data-role="content" data-theme="c" style="padding: 0; height: 100%">
					<div id="loadsMap" style="height: 100%;"></div>
			</div>
		</div>
	<!-- *********************************************************
       	 NEARME PAGE END
        ********************************************************* -->
	
	
	<!-- *********************************************************
       	 JOBS PAGE BEGIN
        ********************************************************* -->
		<div id="jobs" data-role="page" data-theme="c">
			<!--<div data-role="header" class="header" data-theme="a" data-position="fixed">-->
			<div data-role="header" class="header" data-theme="a">
				<a href="javascript:;" class="showMenu menuBtn">Menu</a>
				<!--<div class="logo">&nbsp;</div>-->
				<h1>My Jobs</h1>
				<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
			</div>
			<div data-role="content" data-theme="c">
				
				<h2 style="text-align: center">Current Jobs List</h2>
				<p style="text-align: center">Touch on a job to view full details</p>
				<div id="noJobs" style="text-align: center; height: 237px; background-image: url(assets/images/noJobsIcon.png); background-repeat: no-repeat; background-position: center top; margin-bottom: 280px;">
					<!--<img src="assets/images/noJobsIcon.png" style="margin: 0 auto;" />-->
					&nbsp;
				</div>
				<ul data-role="listview" data-divider-theme="b" data-inset="true" id="jobsList">
					
				</ul>
				
				
			
							    
			</div>
			
		</div>
		
		<div data-role="page" id="jobDetail">
			<form id="jobDetailForm" name="jobDetailForm" action="javascript:;" method="post" class="validate">
				<div data-theme="a" data-role="header">
				    <h1>
					Job Info
				    </h1>
				    <a href="#jobs" class="ui-btn-left backBtn" data-direction="reverse" data-transition="slide">back</a>
				    <a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
				</div>
			
				<div data-role="content">
					<h3 style="text-align: center">
						<span id="jobFrom">
							
						</span> to <span id="jobTo"></span>
						<br />
						<span id="jobCollectionDate" style="font-weight: normal;"></span>
					</h3>
					<h4 style="text-align: center">
						Current Status: <span id="jobStatus"></span>
					</h4>
					
					<div class="field control-group" style="margin: 20px 0;">
						<div class="controls">
							<select id="ddlJobStatus" data-placeholder="true" class="required initial">
								<option value="" data-placeholder="true">
									Select Job Status...
								</option>
							</select>
						</div>
					</div>
					
					
					<button data-theme="b" id="btnStatusUpdate">Update Status</button>
					<div class="clearfix" style="margin-bottom: 100px;"></div>
				</div>
			
				<div data-theme="a" data-role="footer" data-position="fixed">

				</div>
			</form>	
		    </div>  
	<!-- *********************************************************
       	 JOBS PAGE END
        ********************************************************* -->
		
	
	<!-- *********************************************************
       	 UPDATESTATUS PAGE BEGIN
        ********************************************************* -->
		<div data-role="page" id="updateStatus" data-theme="c" class="pages">
			
			<form id="jobStatusForm" name="jobStatusForm" action="javascript:;" method="post" class="validate">
				<div data-role="header" class="header" data-theme="a">
				<a href="javascript:;" class="showMenu menuBtn">Menu</a>
				<div class="logo">&nbsp;</div>
				<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
				</div>
			
				<div data-role="content" data-theme="c">	
					<h2 style="text-align: center;">Update Job Status</h2>
					<p style="text-align: center;">Vehotrans will publish the status of your selected job</p>
					
					
					<div id="statusUpdateDetails" style="display: none;">
						<br />
						<h3 style="text-align: center">
							<span id="updatedJobInfo">
								
							</span>
						</h3>
						<h4 style="text-align: center">
							Current Status: <span id="updatedJobStatus"></span>
						</h4>
					</div>
					
					
					
					<div class="field control-group" style="margin: 20px 0;">
						<div class="controls">
							<select id="ddlJob" data-placeholder="true" class="required initial">
								<option value="">
									Select Your Job...
								</option>
							</select>
						</div>
					</div>
					
					<div class="field control-group" style="margin: 20px 0;">
						<div class="controls">
							<select id="ddlJobStatus2" data-placeholder="true" class="required initial">
								<option value="">
									Select Status...
								</option>
							</select>
						</div>
					</div>
					
					<button data-theme="b" id="btnUpdateJobStatus">Update Status</button>
					<div class="clearfix" style="margin-bottom: 100px;"></div>
					
				</div><!-- /content -->
			</form>
		</div>
	<!-- *********************************************************
       	 UPDATESTATUS PAGE END
        ********************************************************* -->	
		
	
		
	<!-- *********************************************************
       	 P.O.D. PAGE BEGIN
        ********************************************************* -->	
		<div data-role="page" id="POD" data-theme="c" class="pages">
			<form id="podForm" name="podForm" action="javascript:;" method="post" class="validate">
				<div data-role="header" class="header" data-theme="a">
				<a href="javascript:;" class="showMenu menuBtn">Menu</a>
				<h1>P.O.D.</h1>
				<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
				</div>
			
				<div data-role="content" data-theme="c">	
					<!--<h2>Proof Of Delivery</h2>-->
					<h2 style="text-align: center;" id="PODTime"></h2>
					<div class="field control-group" style="margin: 20px 0;">
						<div class="controls">
							<select id="ddlPodJob" data-placeholder="true" class="required">
								<option value="">
									Select Your Job...
								</option>
							</select>
						</div>
					</div>
					
					<div class="field control-group" style="margin: 20px 0;">
						<div class="controls">
							<input id="txtSignedBy" type="text" placeholder="Signatory Name" class="required" />
						</div>
					</div>
					
					
					
					<button data-theme="b" id="bntSendPod">Send P.O.D.</button>
					<div class="clearfix" style="margin-bottom: 10px;"></div>
					
					
					
					<div id="PODMap" style="height: 270px;"></div>
					<div id="PODMapInfo" style="padding: 10px;margin-bottom: 300px;">
						<h2 id="PODMapInfoTitle">Map info</h2>
						<p id="PODMapInfoContent">Current Location:</p>
					</div>
					
					
				</div><!-- /content -->
			</form>
		</div>
	<!-- *********************************************************
       	 P.O.D. PAGE END
        ********************************************************* -->
		
		
		
	<!-- *********************************************************
       	 MYACCOUNT PAGE BEGIN
        ********************************************************* -->
		<div data-role="page" id="myAccount" data-theme="c" class="pages">
		
			<div data-role="header" class="header" data-theme="a">
			<a href="javascript:;" class="showMenu menuBtn">Menu</a>
			<div class="logo">&nbsp;</div>
			<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
			</div>
		
			<div data-role="content" data-theme="c">	
				<h2>My Account</h2>
				<p>Change password</p>
				
			</div><!-- /content -->
		</div>
	<!-- *********************************************************
       	 MYACCOUNT PAGE END
        ********************************************************* -->
        
	
	
	<!-- *********************************************************
       	 SUPPORT PAGE BEGIN
        ********************************************************* -->
		<div data-role="page" id="support" data-theme="c" class="pages">
		
			<div data-role="header" class="header" data-theme="a">
			<a href="javascript:;" class="showMenu menuBtn">Menu</a>
			<div class="logo">&nbsp;</div>
			<a href="#home" class="homeBtn" data-transition="slideup" data-direction="reverse">Home</a>
			</div>
		
			<div data-role="content" data-theme="c">	
				<h2 style="text-align: center; margin-bottom: 10px;">Support</h2>
				<p style="text-align: center; margin-bottom: 10px;">If you are experiencing any problems with the Vehotrans mobile app please contact us.  We are here to help.</p>
				<p style="text-align: center; margin-bottom: 10px;">Please email <a href="mailto:support@vehotrans.com">support@vehotrans.com</a></p>
				<p style="text-align: center; margin-bottom: 500px;">Thank you.</p>
				
			</div><!-- /content -->
		</div>
	<!-- *********************************************************
       	 SUPPORT PAGE END
        ********************************************************* -->
	
	
	
	<!-- *********************************************************
       	 LOGIN DIALOG PAGE START
        ********************************************************* -->
	<!--<div data-role="popup" id="loginDialog" data-overlay-theme="a" data-theme="b" data-dismissible="false" data-position-to="window" class="ui-corner-all">
		<div data-role="header" data-theme="a" class="ui-corner-top">
		    <h1>Login Failed</h1>
		</div>
		<div data-role="content" data-theme="d" class="ui-corner-bottom ui-content" style="text-align: center;">
		    <p>Sorry, email &amp; password combination not recognised.</p>
		    <a href="javascript:;" data-role="button" data-inline="true" data-rel="back" data-theme="b">Try Again</a>
		</div>
	</div>-->
	<!-- *********************************************************
       	 LOGIN DIALOG PAGE END
        ********************************************************* -->
	
	<!--</div>-->
	
	<div id="userDataStore"></div>

	<!-- DETECT BROWSER MIGRATION PATCH -->
	<script src="assets/js/jqueryMbBrowserMin.js"></script>
	
	
	<!-- JQUERY MOBILE VEHOTRANS THEME INIT -->
	<script src="assets/js/Theme.js"></script>
	
	<!-- EXTRAS -->
        <script src="assets/js/vendor/zeptoMin.js"></script>
        <script src="assets/js/add2home.js" charset="utf-8"></script><!-- Iphone Bubble  -->
        
	<!-- GOOGLE MAPS -->
	<!--<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false&libraries=places"></script>-->
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true&libraries=places"></script> 
	<!--<script type="text/javascript" src="assets/js/demo.js"></script>-->
	<script type="text/javascript" src="assets/js/jqueryUiMap.js"></script>
	<script type="text/javascript" src="assets/js/jqueryUiMapServices.js"></script>
	<script type="text/javascript" src="assets/js/jqueryUiMapExtensions.js"></script>
	<script type="text/javascript" src="assets/js/markermanager.js"></script>
	
	
	
	
	<script>
		
		
		


		var baseUrl = "http://vehotrans.azurewebsites.net/";
		var lat, lon, co_ords;
		
		
		
 
		
		$(document).on("pageinit", function(){
			
			
			
			//console.log('pageinit called');
			
			//$('#POD').live('pageshow', function() {
			//	var now = new Date();
			//	$("#PODTime").html(now.toString());
			//	getCompanyJobs("podScreen", "DESC");
			//	console.log('calling geolocation');
			//	navigator.geolocation.getCurrentPosition(onGeoSuccess, onGeoError);
			//});
			//
			//function onGeoError(error){
			//	if(error == 1){
			//		alert('Please turn on geolocation services');
			//	}
			//};
			//
			//function onGeoSuccess(position){
			//	lat = position.coords.latitude;
			//	lon = position.coords.longitude;
			//	console.log(lat);
			//	console.log(lon);
			//	
			//	//var currentPosition = new google.maps.LatLong(lat, lon);
			//	
			//	
			//}
		});
		
		


		
		
		
		
		
		var GPSTimeout = 10; //init global var NOTE: I noticed that 10 gives me the quickest result but play around with this number to your own liking
		
		
		//function to be called where you want the location with the callback(position)
		function getLocation(callback)
		{   
		    if(navigator.geolocation)
		    {
			var clickedTime = (new Date()).getTime(); //get the current time
			GPSTimeout = 10; //reset the timeout just in case you call it more then once
			ensurePosition(callback, clickedTime); //call recursive function to get position
		    }
		    return true;
		}

		//recursive position function
		function ensurePosition(callback, timestamp)
		{
		    if(GPSTimeout < 6000)//set at what point you want to just give up
		    {
			//call the geolocation function
			navigator.geolocation.getCurrentPosition(
				function(position) //on success
				{
					//if the timestamp that is returned minus the time that was set when called is greater then 0 the position is up to date
					if(position.timestamp - timestamp >= 0)
					    {
						GPSTimeout = 10; //reset timeout just in case
						callback(position); //call the callback function you created
					    }
					    else //the gps that was returned is not current and needs to be refreshed
					    {
						GPSTimeout += GPSTimeout; //increase the timeout by itself n*2
						ensurePosition(callback, timestamp); //call itself to refresh
					    }
					},
					function() //error: gps failed so we will try again
					{
					    GPSTimeout += GPSTimeout; //increase the timeout by itself n*2
					    ensurePosition(callback, timestamp);//call itself to try again
					},
					{maximumAge:0, timeout:GPSTimeout}
				)
		    }       
		}
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		function storePosition(position){
			
		}
		
		
		
		$(document).ready(function() {
			
			
			getLocation(function(position){
				//do something cool with position
				console.log(position);
				lat = position.coords.latitude;
				lon = position.coords.longitude;
				co_ords = new google.maps.LatLng(lat, lon)
				geocoder = new google.maps.Geocoder();
				geocoder.geocode({'latLng': co_ords}, function(results, status) {
				    
				    if (status == google.maps.GeocoderStatus.OK) {
					if (results[1]) {
						
						
						var components = results[1].address_components;
						var postcode = null;
						var country = null;
						var placename = null;
						for (var i = 0, component; component = components[i]; i++) {
						    
						    switch(component.types[0]){
							
							case "postal_code":
								postcode = component['long_name'];
								break;
							case "country":
								country = component['short_name'];
								break;
							case "locality":
								placename = component['long_name'];
								break;
							
						    }
						}
						
						$("#userDataStore").data({"geoCountry": country});
						$("#userDataStore").data({"geoPostcode": postcode});
						$("#userDataStore").data({"geoPlacename": placename});
						
						$("#userDataStore").data({"geoAddress": results[1].formatted_address});
						$("#userDataStore").data({"geoLatLon": co_ords});
						
					} else {
						alert('No results found');
						}
				    } else {
					alert('Geocoder failed due to: ' + status);
				    }
				});
			    });
			
			
			
			if(!Modernizr.input.placeholder){

				$('[placeholder]').focus(function() {
				  var input = $(this);
				  if (input.val() == input.attr('placeholder')) {
					input.val('');
					input.removeClass('placeholder');
				  }
				}).blur(function() {
				  var input = $(this);
				  if (input.val() == '' || input.val() == input.attr('placeholder')) {
					input.addClass('placeholder');
					input.val(input.attr('placeholder'));
				  }
				}).blur();
				$('[placeholder]').parents('form').submit(function() {
				  $(this).find('[placeholder]').each(function() {
					var input = $(this);
					if (input.val() == input.attr('placeholder')) {
					  input.val('');
					}
				  })
				});
			
			}
			
			
			
			
			
			
			// needs to be present
			$(this).delegate("body", "pageinit", function(ev, data){
				//alert("pageinit called");
				}); 
			
			
			
			
			/* *********************************************************
			FORMS VALIDATION AND PROCESSING
			********************************************************* */
			Theme.init();
			Theme.showValidationTicks = false;
			
			var rules = {
				rules: {
				}
			};
			
			var vehoMobiValidationDefaults = Theme.validationRules;
			
			
			
			
			// LOGIN
			var loginHandler = {
				submitHandler: function(form){
					login();
				}
			}
			var customLoginMethods = Theme.validationRules;
			var loginValidationObj = $.extend(
							loginHandler,
							customLoginMethods
						);
			
			
			$('#btnLogin').click(function(){
				$('#loginForm').validate(loginValidationObj)
			});
			
			
			
			
			
			
			
			
			
			
			
			
			/* *********************************************************
			UPDATE STATUS
			********************************************************* */
			$('#btnStatusUpdate').click(function(){
				this.validationDefaults = Theme.validationRules;
				this.updateHandler = {
					submitHandler: function(form) {
						updateJobStatus($("#jobDetail").data("JobGuid"), $("#ddlJobStatus").val(), $("#userDataStore").data("GUID"), $("select[id=ddlJobStatus] option:selected").text(), "jobDetailScreen")
					}
				}
				this.validationObj = $.extend(
					this.validationDefaults,
					this.updateHandler
				);
				$('#jobDetailForm').validate(this.validationObj);

			});
			
			
			/* *********************************************************
			UPDATE JOB STATUS
			********************************************************* */ 
			$('#btnUpdateJobStatus').click(function(){
				
				this.validationDefaults = Theme.validationRules;
				this.updateHandler = {
					submitHandler: function(form) {
						updateJobStatus($("#ddlJob").val(), $("#ddlJobStatus2").val(), $("#userDataStore").data("GUID"), $("select[id=ddlJobStatus2] option:selected").text(), "updateStatusScreen")
					}
				}
				this.validationObj = $.extend(
					this.validationDefaults,
					this.updateHandler
				);
				
				$('#jobStatusForm').validate(this.validationObj);
			});
			
			
			/* *********************************************************
			SEND POD
			********************************************************* */ 
			var postPOD = function () {	
				
				$.mobile.loading( 'show', {
					text: "Sending P.O.D....",
					textVisible: true,
					theme: "a",
					textonly: false
				});
				
				
				$.ajax({ 
					type: "POST",
					url: baseUrl + "job/pod/" + $("#ddlPodJob").val() + '/' + $("#userDataStore").data("GUID") + '/' + $("#txtSignedBy").val() + '/' + $("#userDataStore").data("geoAddress"),
					dataType: "json",
					success: function (data) {
						$.mobile.loading("hide");
						alert("POD has been sent to Vehotrans");
					},
					error: function(jqXHR, textStatus, errorThrown ){
						$.mobile.loading("hide");
						alert('Network error has occurred.  Do you have an internet connection?');
					},
				
				});
			};
			$('#bntSendPod').click(function(){
				this.validationDefaults = Theme.validationRules;
				this.updateHandler = {
					submitHandler: function(form) {
						// POST POD
						postPOD();
					}
				}
				this.validationObj = $.extend(
					this.validationDefaults,
					this.updateHandler
				);
				
				$('#podForm').validate(this.validationObj);
			});
			
			
			/* *********************************************************
			END FORMS VALIDATION
			********************************************************* */
			
			
			
			
			
			
			
			
			

			
			
			
			
			// UPDATE JOB STATUS
			var updateJobStatus = function (jobGuid, statusId, userGuid, statusName, callOrigin) {	
				
				$.mobile.loading( 'show', {
					text: "Posting Update...",
					textVisible: true,
					theme: "a",
					textonly: false
				});
				$.ajax({
					type: "POST",
					url: baseUrl + "job/statusAdd/"  + jobGuid + '/' + statusId + '/' + userGuid,
					dataType: "json",
					success: function (data) {
						$.mobile.loading("hide");
						
						// need switcher here
						switch (callOrigin){
							case "jobDetailScreen":
								$('#jobStatus').html(statusName);
								$('#ddlJobStatus')[0].selectedIndex = 0;
								$('#ddlJobStatus').selectmenu("refresh", true);
								break;
							
							case "updateStatusScreen":
								
								//display the details
								$('#updatedJobInfo').html($("select[id=ddlJob] option:selected").text());
								$('#updatedJobStatus').html($("select[id=ddlJobStatus2] option:selected").text());
								$('#statusUpdateDetails').show();
								
								// reset the dropdowns
								$('#ddlJobStatus2')[0].selectedIndex = 0;
								$('#ddlJobStatus2').selectmenu("refresh", true);
								
								$('#ddlJob')[0].selectedIndex = 0;
								$('#ddlJob').selectmenu("refresh", true);
								
								
								break;
						}
						
						
						alert('job successfully updated')
						
	
						
					},
					error: function(jqXHR, textStatus, errorThrown ){
						$.mobile.loading("hide");
						alert('Sorry, we could not update your status.  Please ensure that you select a status from the option list.');
					},
				
				});
			};
			
			
			
			
			// LOGIN USER	
			var login = function () {	
				
				
			
				$.mobile.loading( 'show', {
					text: "Authenticating...",
					textVisible: true,
					theme: "a",
					textonly: false
				});
				$.ajax({
					
					type: "POST",
					url: baseUrl + "rest/Person/" + $("#txtEmail").val() + "/" + $("#txtPassword").val() ,
					dataType: "json",
					success: function (data) {
						
						if(data.Authenticated){
							// hide the loader
							$.mobile.loading("hide");
							// hide the dialog
							//$('#loginDialog').hide();
							//store credentials with the userDataStore div object
							$("#userDataStore").data({"firstName": data.FirstName, "lastName": data.LastName, "email": data.EmailAddress, "GUID": data.PersonGUID, "companyGUID": data.CompanyGUID});
							// display the username
							$("#welcomeText").html('Welcome back ' + $("#userDataStore").data("firstName") + ' ' + $("#userDataStore").data("lastName"));
							// load the homescreen
							$.mobile.changePage($('#home'), {transition:"fade"});
							
						}else{
							$.mobile.loading("hide");
							//$.mobile.changePage('#loginDialog', {role: 'dialog'});
							alert("Login Failed. Email & Password combination not recognised.");
						}
						
						},
					error: function(jqXHR, textStatus, errorThrown ){
						$.mobile.loading("hide");
						console.log(jqXHR);
						console.log(textStatus);
						console.log(errorThrown);
						//$.mobile.changePage('#loginDialog', {role: 'dialog'});
						alert("There was a problem connecting to the server.  Do you have an internet connection?");
						}
				});
				return false;
			//});
			};
			
			
			});
		

			
			// GET COMPANY VEHICLES
			var getVehicles = function() {
				$.mobile.loading( 'show', {
					text: "Loading vehicles...",
					textVisible: true,
					theme: "a",
					textonly: false
				});
				$.ajax({
					type: "POST",
					url: baseUrl + "vehicle/CompanyVehicles/" + $("#userDataStore").data("companyGUID"),
					dataType: "json",
					success: function (data) {
						$.mobile.loading("hide");
						this.placholder = $("#ddlVehicle option:first-child")[0];
						$("#ddlVehicle").empty();
						$("#ddlVehicle").add(this.placeholder)
						
						var placeHolderElem = $('<option value="" data-placeholder="true">').text('Select Vehicle...');
						placeHolderElem.appendTo('#ddlVehicle')
						data.map(function (val, i){
						    if (val){
							var elem = $('<option>').val(val.VehicleGUID).text(val.VehicleRegNo + ' ' + val.VehicleType);
							elem.appendTo("#ddlVehicle");
						    }
						    
						})
					},
					error: function(jqXHR, textStatus, errorThrown ){
						$.mobile.loading("hide");
						alert('Network error has occurred.  Do you have an internet connection?');
					},
					
				});
			};
			
			
			
			// JOB STATUS LIST HANDLER
			var jobStatusListHandler = function(type, data){
				switch(type){
					case "jobDetailScreen":
						this.placholder = $("#ddlJobStatus option:first-child")[0];
						$("#ddlJobStatus").empty();
						$("#ddlJobStatus").add(this.placeholder)
						
						var placeHolderElem = $('<option value="" data-placeholder="true">').text('Select Job Status...');
						placeHolderElem.appendTo('#ddlJobStatus')
						data.map(function (val, i){
						    if (val){
							var elem = $('<option>').val(val.StatusId).text(val.StatusName);
							elem.appendTo("#ddlJobStatus");
						    }
						    
						})
						break;
					
					case "updateStatusScreen":
						
						this.placholder = $("#ddlJobStatus2 option:first-child")[0];
						$("#ddlJobStatus2").empty();
						$("#ddlJobStatus2").add(this.placeholder)
						
						var placeHolderElem = $('<option value="" data-placeholder="true">').text('Select Job Status...');
						placeHolderElem.appendTo('#ddlJobStatus2')
						data.map(function (val, i){
						    if (val){
							var elem = $('<option>').val(val.StatusId).text(val.StatusName);
							elem.appendTo("#ddlJobStatus2");
						    }
						    
						})
						break;
				}
			}
			
			
			// GET JOB STATUSES
			var getJobStatus = function(displayType) {
				$.mobile.loading( 'show', {
					text: "Loading Job Status...",
					textVisible: true,
					theme: "a",
					textonly: false
				});
				$.ajax({
					type: "POST",
					url: baseUrl + "job/Status",
					dataType: "json",
					success: function (data) {
						$.mobile.loading("hide");
						
						jobStatusListHandler(displayType, data);
						
					},
					error: function(jqXHR, textStatus, errorThrown ){
						$.mobile.loading("hide");
						alert('Network error has occurred.  Do you have an internet connection?');
					},
					
				});
			};
			
			
			
			
			// COMPANY JOBS HANDLER
			var JobsListHandler = function(type, data){
				switch(type){
					case "listview":
						
						var jobDay = "";
						data.map(function (val, i){
						    if (val){
							$('#noJobs').hide();
							if(jobDay != val.StartDateDay){
								var sep = $('<li data-role="list-divider" role="heading">').html(val.StartDateDay);
								sep.appendTo("#jobsList");
								jobDay = val.StartDateDay
							}
							var liElem = $('<li data-theme="c">');
							var aElem = $('<a href="#jobDetail" data-transition="slide">').html(val.StartDateTime + ' ' + val.StartLocation + ' to ' + val.EndLocation)
							aElem.data(val);
							aElem.appendTo(liElem);
							liElem.appendTo("#jobsList");
							$(aElem).click(function(){
								$('#jobDetail').data($(this).data());
							});
						    }else{
							// no values - so show the no jobs logo
							$('#noJobs').show();
						    }
						    
						})
						
						$('#jobsList').listview('refresh');
						
						break;
					
					case "updateStatusScreen":
						
						this.placholder = $("#ddlJob option:first-child")[0];
						$("#ddlJob").empty();
						$("#ddlJob").add(this.placeholder)
						
						var placeHolderElem = $('<option value="" data-placeholder="true">').text('Select Job...');
						placeHolderElem.appendTo('#ddlJob')
						data.map(function (val, i){
						    if (val){
							var elem = $('<option>').val(val.JobGuid).text(val.StartDateDay + ' ' + val.StartDateTime + ' ' + val.StartLocation + ' to ' + val.EndLocation);
							elem.appendTo("#ddlJob");
						    }
						    
						})
						
						break;
					
					case "podScreen":
						
						this.placholder = $("#ddlPodJob option:first-child")[0];
						$("#ddlPodJob").empty();
						$("#ddlPodJob").add(this.placeholder)
						
						var placeHolderElem = $('<option value="" data-placeholder="true">').text('Select Job...');
						placeHolderElem.appendTo('#ddlPodJob')
						data.map(function (val, i){
						    if (val){
							var elem = $('<option>').val(val.JobGuid).text(val.StartDateDay + ' ' + val.StartDateTime + ' ' + val.StartLocation + ' to ' + val.EndLocation);
							elem.appendTo("#ddlPodJob");
						    }
						    
						})
						
						break;
				}
			}
			
			
			// GET COMPANY Jobs
			var getCompanyJobs = function(displayType, sortDirection) {
				
				$("#jobsList").empty();
				
				$.mobile.loading( 'show', {
					text: "Loading jobs...",
					textVisible: true,
					theme: "a",
					textonly: false
				});
				
				$.ajax({
					type: "POST",
					url: baseUrl + "job/CompanyJobs/" + $("#userDataStore").data("companyGUID") + "/" + sortDirection,
					dataType: "json",
					success: function (data) {
						
						JobsListHandler(displayType, data);
						$.mobile.loading("hide");
					},
					
					error: function(jqXHR, textStatus, errorThrown ){
						$.mobile.loading("hide");
						alert('Network error has occurred please try again!');
					},
					
				});
				
				
			};
			
			
			
			
			
			
			
			
			
			
			
			
			
			/************** POD Map *******************/
			function loadPODMap(lat, lon, zoom){
			       $('#PODMap').gmap({
				       'zoom': zoom,
				       'disableDefaultUI':false,
				       'mapTypeControl' : false, 
				       'navigationControl' : true,
				       'streetViewControl' : false, 
				       'callback': function(map) {
						
						var self = this;
						       
						var latlng = new google.maps.LatLng(lat, lon);
						// convert to address
						geocoder = new google.maps.Geocoder();
						geocoder.geocode({'latLng': latlng}, function(results, status) {
							 if (status == google.maps.GeocoderStatus.OK) {
								 if (results[1]) {
									 $("#userDataStore").data({"geoAddress": results[1].formatted_address});
									 $("#userDataStore").data({"geoLatLon": latlng});
									 $("#PODMapInfoTitle").html("Current Location");
									 $("#PODMapInfoContent").html(results[1].formatted_address);
									 
									 
									 console.log(self);
									 
									 // are there any markers currently loaded?
									 if ( !self.get('markers').client ) {
										 // no marker, so add one
										 self.addMarker({
											 'id': 'client',
											 'position': latlng,
											 title: $("#userDataStore").data("geoAddress")
										 });
										 
										 // centre the map
										 map.setCenter(latlng);
										 //map.setZoom(zoom);
										 
									 } else {
										 self.get('markers').client.setPosition(latlng);
										 //map.panTo(latlng);
									 }
									 
								 } else {
									 alert('No results found');
								 }
							 
							 
							 } else {
							     alert('Geocoder failed due to: ' + status);
							 }
						});
						
				       } 
			       });
			}
			
			
			
			// Page Show Functions
			$('#POD').live('pageshow', function() {
				var now = new Date();
				$("#PODTime").html(now.toString());
				getCompanyJobs("podScreen", "DESC");
				
				
				getLocation(function(position){
					lat = position.coords.latitude;
					lon = position.coords.longitude;
					loadPODMap(lat, lon, 10);
				});
				
				//navigator.geolocation.getCurrentPosition(onPODGeoSuccess, onPODGeoError, {maximumAge:7500, timeout:5000, enableHighAccuracy:true});
				
			});
		
			
			
			//var onPODGeoError = function(error){
			//	if(error == 1){
			//		alert('Please turn on geolocation services');
			//	}
			//};
			//
			//var onPODGeoSuccess = function(position){
			//	lat = position.coords.latitude;
			//	lon = position.coords.longitude;
			//	
			//	
			//	loadPODMap(lat, lon, 10);
			//}
			
			
			
			
		
		
		
			
			
			
			
			
			
			
			
			
			
			
		
			
			
			
			
			$('#jobs').live('pageshow', function() {
				getCompanyJobs("listview", "ASC");
			});
			$('#jobDetail').live('pagebeforeshow', function(){
				var jobInfo = $(this).data();
				$('#jobFrom').html(jobInfo.StartLocation);
				$('#jobTo').html(jobInfo.EndLocation);
				$('#jobCollectionDate').html(jobInfo.StartDateDay + ' ' + jobInfo.StartDateTime);
				$('#jobStatus').html(jobInfo.Status == '' ? 'Status has not been set' : jobInfo.Status);	
			});
			$('#jobDetail').live('pageshow', function(){
				getJobStatus("jobDetailScreen");
			});
			$('#updateStatus').live('pagebeforeshow', function() {
				$('#statusUpdateDetails').hide();
			});
			$('#updateStatus').live('pageshow', function() {
				getCompanyJobs("updateStatusScreen", "DESC");
				getJobStatus("updateStatusScreen");
			});
			
			
			
			
			
			
		    
			
			
			
			
			
			
			
			
			
			// this is not needed!!!!!!!!!!!!!!!!!!!!!!!!!!
			// PHONEGAP BUILD INCLUDES THE  CORRECT CORDOVA AT BUILD TIME!!!!
			function selectCordova() {
			    
			    if(isMobile.Android()){
				$("script").attr("src", "lib/android/cordova-2.5.0.js").appendTo("head");
				//alert("android");
			    }else if(isMobile.iOS()){
				$("script").attr("src", "lib/ios/cordova.ios.js").appendTo("head");
				//alert("iOS");
			    }else if(isMobile.BlackBerry()){
				$("script").attr("src", "lib/blackberry/cordova-2.5.0.js").appendTo("head");
				//alert("blackberry");
			    }else if(isMobile.Windows()){
				$("script").attr("src", "lib/windowsPhone7/cordova-2.5.0.js").appendTo("head");
				//alert("Windows");
			    }
			    
			}
			
	
			//function onDeviceReady(){
			//	alert("device is ready");
			//	navigator.geolocation.getCurrentPosition(onGeoSuccess, onGeoError);
			//}
		    
		    
			var isMobile = {
			    Android: function() {
				return navigator.userAgent.match(/Android/i);
			    },
			    BlackBerry: function() {
				return navigator.userAgent.match(/BlackBerry/i);
			    },
			    iOS: function() {
				return navigator.userAgent.match(/iPhone|iPad|iPod/i);
			    },
			    Opera: function() {
				return navigator.userAgent.match(/Opera Mini/i);
			    },
			    Windows: function() {
				return navigator.userAgent.match(/IEMobile/i);
			    },
			    any: function() {
				return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
			    }
			};
			
	
	
			

	</script>
	
	
    
	<script type="text/javascript" src="assets/js/gmaps.js"></script>
	<script type="text/javascript" src="assets/js/availability.js"></script>
    </body>
</html>
